<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Build a template table with automatically matched sequence names — auto_match_seqs • concatipede</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Build a template table with automatically matched sequence names — auto_match_seqs" />
<meta property="og:description" content="The algorithm used to match sequences across fasta files based on their
names is outlined below." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">concatipede</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/Package-usage.html">Example of package usage</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/tardipede/concatipede">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Build a template table with automatically matched sequence names</h1>
    <small class="dont-index">Source: <a href='https://github.com/tardipede/concatipede/blob/master/R/matching.R'><code>R/matching.R</code></a></small>
    <div class="hidden name"><code>auto_match_seqs.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The algorithm used to match sequences across fasta files based on their
names is outlined below.</p>
    </div>

    <pre class="usage"><span class='fu'>auto_match_seqs</span><span class='op'>(</span><span class='va'>x</span>, method <span class='op'>=</span> <span class='st'>"lv"</span>, <span class='va'>xlsx</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>A table (data frame or tibble) typically produced by
<code><a href='concatipede_prepare.html'>concatipede_prepare</a></code>. It must be of the same format as a
table returned by this function: a first column called "name" followed
by one column per fasta file. Those columns have the name of their
corresponding fasta file, and they contain the names of the sequences in
this file, with one sequence name per cell. The number of rows in the
number of sequences of the fasta file with the most sequences, and the
columns for the other fasta files are filled with <code>NA</code> for padding.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>Method for string distance calculation. See
<code>?stringdist::stringdist-metrics</code> for details. Default is
<code>"lv"</code>.</p></td>
    </tr>
    <tr>
      <th>xlsx</th>
      <td><p>Optional, a path to use to save the output table as an Excel
file.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A table (tibble) with the same columns as <code>x</code> and with sequence
names automatically matched across fasta files. Sequence names which did
not have a best reciprocal match in other fasta files are appended to
the end of the table, so that the output table columns contain all the
unique sequence names present in the corresponding column of the input
table. The first column, "name", contains a suggested name for the row
(not guaranteed to be unique). If a path was provided to the <code>xlsx</code>
argument, an Excel file is saved and the table is returned invisibly.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Let's assume a situation with N fasta files, with each fasta file i having
n_i sequence names. The problem of matching the names in the best possible
way across the fasta files is similar to that of identifying homologous
proteins across species, using e.g. reciprocal blast.</p>
<p>The algorithm steps are:</p><ul>
<li><p>For each pair of fasta files, identify matching names using a
reciprocal match approach: two names match if and only if they are their
reciprocal best match.</p></li>
<li><p>Those matches across fasta files define a graph.</p></li>
<li><p>We identify sub-graphs such that (i) they contain at most one
sequence name per fasta file and (ii) all nodes in a given sub-graph are
fully connected (i.e., they are all their best reciprocal matches across
any pair of fasta files).</p></li>
</ul>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>xlsx_file</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"extdata"</span>, <span class='st'>"sequences-test-matching.xlsx"</span>,
                         package <span class='op'>=</span> <span class='st'>"concatipede"</span><span class='op'>)</span>
<span class='va'>xlsx_template</span> <span class='op'>&lt;-</span> <span class='fu'>readxl</span><span class='fu'>::</span><span class='fu'><a href='https://readxl.tidyverse.org/reference/read_excel.html'>read_xlsx</a></span><span class='op'>(</span><span class='va'>xlsx_file</span><span class='op'>)</span>
<span class='fu'>auto_match_seqs</span><span class='op'>(</span><span class='va'>xlsx_template</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span style='color: #949494;'># A tibble: 405 x 5</span>
#&gt;    name   al18S_aligned_MA… al28S_aligned_MA… COI_aligned_Musc… ITS2_aligned_MA…
#&gt;    <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>  <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>             <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>             <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>             <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>           
#&gt; <span style='color: #BCBCBC;'> 1</span> Macro… KT935502_Macrobi… KT935501_Macrobi… KT951668_Macrobi… KT935500_Macrob…
#&gt; <span style='color: #BCBCBC;'> 2</span> Mesob… KX129793_Mesobio… KX129794_Mesobio… KX129796_Mesobio… KX129795_Mesobi…
#&gt; <span style='color: #BCBCBC;'> 3</span> Tenui… KX810045_Tenuibi… KX810049_Tenuibi… KX810042_Tenuibi… KX810046_Tenuib…
#&gt; <span style='color: #BCBCBC;'> 4</span> Macro… KY797265_Macrobi… KY797266_Macrobi… KY797267_Macrobi… KY797268_Macrob…
#&gt; <span style='color: #BCBCBC;'> 5</span> Mesob… MF441488_Mesobio… MF441489_Mesobio… MF441491_Mesobio… MF441490_Mesobi…
#&gt; <span style='color: #BCBCBC;'> 6</span> Param… MF568532_Paramac… MF568533_Paramac… MF568534_Paramac… MF568535_Parama…
#&gt; <span style='color: #BCBCBC;'> 7</span> Macro… MH063922_Macrobi… MH063924_Macrobi… MH057764_Macrobi… MH063923_Macrob…
#&gt; <span style='color: #BCBCBC;'> 8</span> Macro… MH063926_Macrobi… MH063935_Macrobi… MH057767_Macrobi… MH063931_Macrob…
#&gt; <span style='color: #BCBCBC;'> 9</span> Mesob… MH197148_Mesobio… MH197265_Mesobio… MH195153_Mesobio… MH197156_Mesobi…
#&gt; <span style='color: #BCBCBC;'>10</span> Mesob… MH197149_Mesobio… MH197266_Mesobio… MH195154_Mesobio… MH197157_Mesobi…
#&gt; <span style='color: #949494;'># … with 395 more rows</span></div><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'>auto_match_seqs</span><span class='op'>(</span><span class='va'>xlsx_template</span>, xlsx <span class='op'>=</span> <span class='st'>"my-automatic-output.xlsx"</span><span class='op'>)</span>
<span class='op'>}</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Matteo Vecchi, Mattieu Bruneaux.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


